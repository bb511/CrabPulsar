(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65809,       1624]
NotebookOptionsPosition[     63925,       1558]
NotebookOutlinePosition[     64262,       1573]
CellTagsIndexPosition[     64219,       1570]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Remainders Analysis", "Title",
 CellChangeTimes->{{3.752318717978038*^9, 3.75231872730833*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Preliminaries", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Data\>\"", ",", 
        " ", "\"\<PeriodFitData\>\""}], "}"}], "]"}], " ", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Period", " ", "formula"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"truePeriod", " ", "[", 
      RowBox[{"slope_", ",", " ", "periodGuess_"}], "]"}], ":=", 
     FractionBox["1", 
      RowBox[{
       FractionBox["1", "periodGuess"], "-", "slope"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]truePeriod", "[", 
      RowBox[{"slopes_", ",", " ", "periodGuess_", ",", "\[Sigma]slopes_"}], 
      "]"}], ":=", " ", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "periodGuess"], "-", "slopes"}], ")"}], "2"]], "*",
       "\[Sigma]slopes"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7523194493671293`*^9, 3.752319475059822*^9}, {
   3.752319532253832*^9, 3.752319552668436*^9}, {3.752324430111413*^9, 
   3.752324491643306*^9}, {3.7523245868991117`*^9, 3.7523246413715773`*^9}, {
   3.752325349994125*^9, 3.752325479829899*^9}, {3.752325512804184*^9, 
   3.752325532352326*^9}, 3.752347286210943*^9, {3.752433572071804*^9, 
   3.752433608296954*^9}, {3.7524336804059134`*^9, 3.7524336836607027`*^9}, {
   3.752434380510292*^9, 3.752434474281966*^9}}],

Cell[CellGroupData[{

Cell["Crab 1", "Chapter",
 CellChangeTimes->{{3.7523187366828213`*^9, 3.752318743987502*^9}, {
  3.752347260858755*^9, 3.752347288919753*^9}, {3.7523474180021267`*^9, 
  3.752347443264757*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Estimated", " ", "Period"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"periodGuess", " ", "=", " ", "0.0337552412"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Import", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"times", " ", "=", " ", 
     RowBox[{"ReadList", "[", 
      RowBox[{"\"\<crab1times.txt\>\"", ",", " ", "Number"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"remainders", "=", " ", 
     RowBox[{"ReadList", "[", 
      RowBox[{"\"\<crab1remainders.txt\>\"", ",", " ", "Number"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", " ", "=", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"times", ",", " ", "remainders"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"data", ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
     RowBox[{"Frame", "->", "True"}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", "700"}], ",", " ", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", " ", "Thick"}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.752318728935096*^9, 3.7523187324828978`*^9}, {
  3.752318829697213*^9, 3.752318838681403*^9}, {3.752319013892539*^9, 
  3.752319051057559*^9}, {3.7523194438799*^9, 3.752319447399856*^9}, {
  3.752319479246324*^9, 3.752319523678337*^9}, {3.7523195638707027`*^9, 
  3.752319582572793*^9}, {3.752319663346179*^9, 3.7523197188359957`*^9}, {
  3.752319777892959*^9, 3.752319778464101*^9}, {3.752319818883458*^9, 
  3.752319829598885*^9}, {3.752319884010817*^9, 3.752319925628353*^9}, {
  3.7523199724663897`*^9, 3.752320040772537*^9}, {3.7523215274957457`*^9, 
  3.752321542115253*^9}, {3.7523216149601717`*^9, 3.7523216358521843`*^9}, {
  3.752344102439209*^9, 3.752344156511326*^9}, {3.752433581327663*^9, 
  3.752433616138382*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[1, 0, 0], PointSize[0.011000000000000001`], Thickness[Large], 
     PointBox[CompressedData["
1:eJwd0n0s1HEcB/CblJinLmc3K6YUKVdrssrDN0okD+s8NsqleZiGS8hwTHNU
Z9ydY5yn89SGcVHqppGOMvOwojDPT5uLG1IuT6nPpz9+++217/f7e7+/v+/X
NCSGGapGoVBs4MF3NfuSl2pg3bE0bZa22SMhYWFjsWiBVz/d/1wgmU3iF6Kt
Lq6PyuSxRGXxuQ3tnDIW6a6RSky4gfP/1z8+zF3pyYDxiYO/wQ0d/onCzOdk
pCqIgRYGFj944/mUNLpMeqOPjsectdLJI/Za3oloVnuLx5f5fJgfUYrOirZr
ih8uJBSKqAttyUrqbRkuBlMUaP00m+vWtWWEu+x7aBPMtxw6HbAsIeIi2gU0
s9OtMvUtC/ooA9CpFjNmwZxHMH82Da0rrrinXpNGcuXpVWh69KqBiM0lD+0H
e9Ftgy5StVYe9Lu/hmbnhH5vlvOJQeM8bQs84aAxr96eR5iy1stojrtmRV9Z
AVHeWmChqc4hrWY1RdCXlYmWNn2VCepKiOvsVB1a5Cdoss0uh/Vzg+iSEz3J
5VITcipoWYXuodE7GrbDoU/CkW0wkbfojVATIX/RES31ZbBqlemkvy8iHB0Z
fI3nq8yC9a+y0Rrd4pdXXXJIssHdZrTq0xzz9QEh0RpZHEELK3dOamvkw/fX
d9Ge78KviCmF0Gfp2A44mLodtatXjOfnil7s1k6YNiyD/Smj0L1BeQ7CXAnk
L4jQXqpuu/DKQNK5oZShfXzqP5gmxRKZcf8k+nx0zvEAXir0Wdm3C46budM9
KuKSavaWOdpvKENvIJ4H+Sue6PEBTdu+aT7sJyYOHfKz3tp4Lw/6rxahOSoP
xtrfArif7PdoJX/V/AldDHk/FtA3PgpMfcxKSVDuC60/4E1yJrSEIYF8KgNt
tD+/UpHjBPed6Y+218tU2GqyIe8mB029Hav7bSAFzi9OgnaacrVd0M6A8zPq
Qmdu6mywdp5BXvwyepyn0Dd048P/itPcAy/92iL8cSH5Bwam3E8=
      
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{5.048853253032187*^9, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->700,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{5.04885374759*^9, 5.04888539929*^9}, {0, 0.0330455354211}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.752320022294685*^9, 3.752320041548224*^9}, 
   3.752320344316289*^9, {3.752321523372059*^9, 3.752321544454996*^9}, {
   3.752321630986844*^9, 3.752321636348474*^9}, {3.752344113584774*^9, 
   3.7523441468531847`*^9}, 3.7524345456110773`*^9, 3.752435830209248*^9, 
   3.7524362745625*^9, 3.7524368987388067`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Separate", " ", "data", " ", "into", " ", "full", " ", "periods"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"peaksIdxs", " ", "=", " ", 
     RowBox[{
      RowBox[{"FindPeaks", "[", "remainders", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sepData", " ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"peaksIdxs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ";;", " ", 
          RowBox[{"peaksIdxs", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "@", "peaksIdxs"}], " ", "-", " ", "1"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "each", " ", "period"}], ",", " ", 
     RowBox[{"find", " ", "slopes"}], ",", " ", 
     RowBox[{"errors", " ", "and", " ", "the", " ", "residuals"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slopes", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"LinearModelFit", "[", 
          RowBox[{
           RowBox[{"sepData", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "x", ",", "x"}], "]"}], "[", 
         "\"\<BestFitParameters\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "sepData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]slopes", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"LinearModelFit", "[", 
          RowBox[{
           RowBox[{"sepData", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "x", ",", "x"}], "]"}], "[", 
         "\"\<ParameterErrors\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "sepData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"residuals", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LinearModelFit", "[", 
         RowBox[{
          RowBox[{"sepData", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "x", ",", "x"}], "]"}], "[", 
        "\"\<FitResiduals\>\"", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "sepData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fit", " ", "statistics"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nDof", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"sepData", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "-", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", " ", 
         RowBox[{"Length", "@", "sepData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]sq", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Total", "[", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"residuals", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ")"}], "2"], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "residuals"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["E", 
            RowBox[{
             RowBox[{"-", "\[Chi]s"}], "/", "2"}]], "*", 
           SuperscriptBox["\[Chi]s", 
            RowBox[{
             FractionBox[
              RowBox[{"nDof", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "2"], "-", "1"}]]}], 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"nDof", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "2"}]], "*", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             RowBox[{"nDof", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}]], ",", 
         RowBox[{"{", 
          RowBox[{"\[Chi]s", ",", 
           RowBox[{"\[Chi]sq", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "Infinity"}], "}"}]}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", " ", 
         RowBox[{"Length", "@", "\[Chi]sq"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Test", " ", "plot"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lm", " ", "=", " ", 
     RowBox[{"LinearModelFit", "[", 
      RowBox[{
       RowBox[{"sepData", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "x", ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xdata", " ", "=", " ", 
     RowBox[{
      RowBox[{"sepData", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"sepData", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}], ",", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"lm", "[", "x", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Min", "[", "xdata", "]"}], ",", " ", 
         RowBox[{"Max", "[", "xdata", "]"}]}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", " ", "Thick"}], "}"}]}]}], "]"}], ",", " ", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", "700"}], ",", " ", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Example Plot\>\""}], ",", " ", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "20", "]"}]}], ",", " ", 
     RowBox[{"FrameTicksStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", "20", "]"}], ",", 
        RowBox[{"Directive", "[", "12", "]"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Outputting", " ", "the", " ", "results"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) values:\>\"", ",", " ",
          "Bold"}], "]"}], ",", "\"\< \>\"", ",", " ", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"\[Chi]sq", ",", "5"}], "]"}]}], "}"}], "]"}], "]"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<Reduced \!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) values:\>\"", 
         ",", " ", "Bold"}], "]"}], ",", "\"\< \>\"", ",", " ", 
       RowBox[{"NumberForm", "[", 
        RowBox[{
         FractionBox["\[Chi]sq", "nDof"], ",", "5"}], "]"}]}], "}"}], "]"}], 
    "]"}], "  ", "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<The probability of getting this \!\(\*SuperscriptBox[\(\[Chi]\), \
\(2\)]\):\>\"", ",", " ", "Bold"}], "]"}], ",", "\"\< P = \>\"", ",", "p"}], 
      "}"}], "]"}], "]"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7523203984467916`*^9, 3.7523204049868717`*^9}, {
   3.7523204466556168`*^9, 3.752320464991235*^9}, {3.752320543477601*^9, 
   3.7523205710899*^9}, {3.752320814805937*^9, 3.75232081695255*^9}, 
   3.7523216021523743`*^9, {3.752321777662689*^9, 3.752321798254209*^9}, {
   3.752321834773838*^9, 3.752321906939396*^9}, {3.752322376141884*^9, 
   3.7523223766140203`*^9}, {3.7523224875817623`*^9, 3.752322504761642*^9}, {
   3.7523225814763403`*^9, 3.752322688076665*^9}, {3.7523227731046543`*^9, 
   3.752322798524002*^9}, {3.752322848129259*^9, 3.752323104093446*^9}, {
   3.752323172594862*^9, 3.752323236107151*^9}, {3.7523233008407183`*^9, 
   3.752323305909254*^9}, {3.7523235321622877`*^9, 3.75232358298038*^9}, 
   3.752323621062521*^9, {3.7523236916354523`*^9, 3.752323693952559*^9}, {
   3.7523240249195757`*^9, 3.752324082937909*^9}, 3.7523242328235188`*^9, {
   3.752324276715713*^9, 3.7523243021654787`*^9}, {3.752324350716525*^9, 
   3.752324420386421*^9}, {3.752324652188723*^9, 3.752324670393711*^9}, {
   3.75232470575255*^9, 3.752324791104035*^9}, {3.752324909550992*^9, 
   3.752324944557976*^9}, {3.752325101991527*^9, 3.75232514668974*^9}, {
   3.752325196638406*^9, 3.752325266930648*^9}, {3.752325543650173*^9, 
   3.752325567895997*^9}, {3.752325709487197*^9, 3.752325758053898*^9}, {
   3.7523258005655613`*^9, 3.752325820854447*^9}, {3.7523258706656227`*^9, 
   3.7523258708307962`*^9}, 3.75234416512918*^9, {3.752344285691585*^9, 
   3.752344300871298*^9}, {3.752344349798729*^9, 3.752344414284482*^9}, {
   3.7523445203196173`*^9, 3.752344556056807*^9}, {3.752344592509219*^9, 
   3.752344711824707*^9}, {3.752344745320571*^9, 3.752344801141789*^9}, {
   3.752345447081894*^9, 3.752345480417138*^9}, {3.752345523807768*^9, 
   3.752345622684753*^9}, {3.752345665847333*^9, 3.752345839262794*^9}, {
   3.7523458809342117`*^9, 3.75234596438846*^9}, {3.7523461101336203`*^9, 
   3.752346321902191*^9}, {3.75234677615023*^9, 3.752346831377775*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {GrayLevel[0], PointSize[0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{5.04886152135*^9, 0.00204062207407}, {5.04886209476*^9, 
       0.00475823560374}, {5.04886271812*^9, 0.00772573195909}, {
       5.04886328811*^9, 0.0104686325921}, {5.04886393314*^9, 
       0.0135383805982}, {5.04886451819*^9, 0.0163677172617}, {
       5.04886511823*^9, 0.0192795527999}, {5.04886570767*^9, 
       0.0220901463784}, {5.04886631827*^9, 0.0250440348396}, {5.048866918*^9,
        0.0279944199621}, {5.04886750193*^9, 
       0.0308083846215}}]}, {}}, {}, {}, {{}, {}}}, {{{}, {}, 
     {RGBColor[1, 0, 0], Thickness[Large], Opacity[1.], 
      LineBox[CompressedData["
1:eJw10H9Qk3UcB/Ad1HmOLijUCVaoV3dIGE92kRL1Hj8WOVE4JzNh0tMYghAE
GDURaNgMnQhDQBDavqaCSB5IkZaWLCkQLhCKANfE5e2Oiwg8uQK0IOv5PH88
9zyve3++P97PKu07W5PdJBLJ5gfPf2/f2qUvzvbdDXvwefzHYB6+0+tEn4rb
yGNFdKzo5pEEHk/Mm8iGq6MGHk9pJcGUT4z38Fgd8LtouL/5FgIu2dbTvOuF
Yi1etqeHkrmqYR00Mj6S5tnCL7uh1vVuonx79OFMHE5eqhIsjzxUno32pPvx
NP+63PNd9GbHa8nZqdr3YM/fnkY+oBvTY3VoUA6tj7Pw+xDhYdgr2KaMaimA
bjiziFx1W2ZA4udDB8nL7eFFqIjwMQt2zk2l7EdX/1w13a9/qv5DDGaomOAT
Gxr7jPh10aYzlNcovT7CGvWTLeQ4j+hiKNtSLwheWW/MOYg0z61XyONjrYeQ
lNf2PZ3/rbvDBM3ttl7qU7bYrwTm+bKfab9LazVHYAlwOch6qbEUTaohF+0X
OPBdGcwlYROCuQ3+ejNa9xZPC+Y9ZqTlGEhKvy84diSkqRw9O6+5zf1v86T9
1aPo2NYhFXxiYerWUcws1Dwu2IYlhRV46PKYj2Cuu/KxSnjtGVwlmN9saq3E
nyEhawT3+zpeq8Kyi3kc5bJXblQhmNuxnvZ71Ft/DEFfnQflMYpHquGPhijB
TtPEuWrcG1wSQ/fxvBNeg0V+iWrBWR1uQzXw3qVIFCzJMeUex+zX9cm0fnem
tBY3vU5nUD9N16e1+Gd5QS6dVxikrMNf3PV88m/TN+swqWg3Ur+YtYUfoz3N
v0SwfP6qtwU/RLxdIdjgSGmwYMRnSx35iyKFFd8sNJ6k/sMzN6wIH+4mO22l
Dis6m8fF/Owzt6zo2xl4iv7HPpXLitHLLeTzfi2TVkj0F05T/5Rd7gzhdzoa
qP/MYCBDZ5eLzDvTgxiU7OEz5G63dQyqLVGi67iXGHTnekSjJIzhQOpAI/Ur
jlAzSOV3ybFZ9jcYSmXeZ8k7shMYjnVuI8ufZTxDw9MjZO76vTSGgL9nySu/
LM9gaP7Jp4n8iX8Ww8X9CaL3qHMZQuPzyZzmj/cZbM9bRCuMeQyRi6+I88+t
KGC45hwVLfvsA4Z/AVKdT3Q=
       "]]}}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{5.048861427903439*^9, 0},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  FrameTicksStyle->{
    Directive[20], 
    Directive[12]},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->700,
  LabelStyle->Directive[20],
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"Example Plot\"", TraditionalForm],
  PlotRange->{{5.04886152135*^9, 5.04886750193*^9}, {0, 0.0308083846215}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.752320407948081*^9, 3.7523205676106863`*^9, 3.752322565252533*^9, {
   3.7523226061586514`*^9, 3.7523226884953136`*^9}, 3.7523227945263977`*^9, 
   3.752322869194913*^9, 3.752322921673595*^9, 3.752323033395369*^9, {
   3.75232306464464*^9, 3.752323077079276*^9}, 3.75232319888958*^9, {
   3.752323286629418*^9, 3.752323309892489*^9}, {3.7523235282957993`*^9, 
   3.7523235842181997`*^9}, {3.7523240498940687`*^9, 
   3.7523240596155853`*^9}, {3.752324211882804*^9, 3.752324234126001*^9}, 
   3.7523243572785997`*^9, 3.752324717089819*^9, {3.752324749344965*^9, 
   3.7523247648265142`*^9}, {3.752324924790785*^9, 3.752324945083747*^9}, 
   3.752325114204612*^9, 3.752325147958848*^9, {3.752325261593741*^9, 
   3.752325269007924*^9}, 3.752325579755866*^9, 3.752325692138822*^9, 
   3.7523257594710197`*^9, {3.752325801980692*^9, 3.752325821773622*^9}, 
   3.75232587140527*^9, 3.752344168146637*^9, {3.752345462012429*^9, 
   3.752345483349168*^9}, 3.75234562784304*^9, {3.752345666531226*^9, 
   3.7523457171497517`*^9}, {3.752345783392747*^9, 3.752345799156814*^9}, 
   3.752345841452517*^9, 3.752345965150894*^9, {3.752346299572563*^9, 
   3.752346323065484*^9}, {3.752346784510931*^9, 3.752346832314665*^9}, 
   3.752434550321247*^9, 3.7524358328692837`*^9, 3.752436277496244*^9, 
   3.752436905879265*^9}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    TemplateBox[{
     StyleBox["\"\\!\\(\\*SuperscriptBox[\\(\[Chi]\\), \\(2\\)]\\) values:\"",
        Bold, StripOnInput -> False],"\" \"",TagBox[
       RowBox[{"{", 
         RowBox[{
           InterpretationBox[
           "\"0.000014434\"", 0.000014433609965995885`, AutoDelete -> True], 
           ",", 
           InterpretationBox[
            RowBox[{"\"1.3868\"", "\[Times]", 
              SuperscriptBox["10", "\"-8\""]}], 1.3868466782399693`*^-8, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"2.3263\"", "\[Times]", 
              SuperscriptBox["10", "\"-8\""]}], 2.3263217683091865`*^-8, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"1.651\"", "\[Times]", 
              SuperscriptBox["10", "\"-8\""]}], 1.650961736491801*^-8, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"1.031\"", "\[Times]", 
              SuperscriptBox["10", "\"-8\""]}], 1.031008896882605*^-8, 
            AutoDelete -> True]}], "}"}], NumberForm[#, 5]& ]},
     "RowDefault"], TextForm]], "InlineText"],
  Text[
   Row[{
     Style["\!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) values:", Bold], " ", 
     NumberForm[{0.000014433609965995885`, 1.3868466782399693`*^-8, 
      2.3263217683091865`*^-8, 1.650961736491801*^-8, 1.031008896882605*^-8}, 
      5]}]]]], "Output",
 CellChangeTimes->{
  3.752320407948081*^9, 3.7523205676106863`*^9, 3.752322565252533*^9, {
   3.7523226061586514`*^9, 3.7523226884953136`*^9}, 3.7523227945263977`*^9, 
   3.752322869194913*^9, 3.752322921673595*^9, 3.752323033395369*^9, {
   3.75232306464464*^9, 3.752323077079276*^9}, 3.75232319888958*^9, {
   3.752323286629418*^9, 3.752323309892489*^9}, {3.7523235282957993`*^9, 
   3.7523235842181997`*^9}, {3.7523240498940687`*^9, 
   3.7523240596155853`*^9}, {3.752324211882804*^9, 3.752324234126001*^9}, 
   3.7523243572785997`*^9, 3.752324717089819*^9, {3.752324749344965*^9, 
   3.7523247648265142`*^9}, {3.752324924790785*^9, 3.752324945083747*^9}, 
   3.752325114204612*^9, 3.752325147958848*^9, {3.752325261593741*^9, 
   3.752325269007924*^9}, 3.752325579755866*^9, 3.752325692138822*^9, 
   3.7523257594710197`*^9, {3.752325801980692*^9, 3.752325821773622*^9}, 
   3.75232587140527*^9, 3.752344168146637*^9, {3.752345462012429*^9, 
   3.752345483349168*^9}, 3.75234562784304*^9, {3.752345666531226*^9, 
   3.7523457171497517`*^9}, {3.752345783392747*^9, 3.752345799156814*^9}, 
   3.752345841452517*^9, 3.752345965150894*^9, {3.752346299572563*^9, 
   3.752346323065484*^9}, {3.752346784510931*^9, 3.752346832314665*^9}, 
   3.752434550321247*^9, 3.7524358328692837`*^9, 3.752436277496244*^9, 
   3.7524369058834743`*^9}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    TemplateBox[{
     StyleBox["\"Reduced \\!\\(\\*SuperscriptBox[\\(\[Chi]\\), \\(2\\)]\\) \
values:\"", Bold, StripOnInput -> False],"\" \"",TagBox[
       RowBox[{"{", 
         RowBox[{
           InterpretationBox[
            RowBox[{"\"1.4434\"", "\[Times]", 
              SuperscriptBox["10", "\"-6\""]}], 1.4433609965995886`*^-6, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"1.5409\"", "\[Times]", 
              SuperscriptBox["10", "\"-9\""]}], 1.5409407535999658`*^-9, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"2.3263\"", "\[Times]", 
              SuperscriptBox["10", "\"-9\""]}], 2.3263217683091867`*^-9, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"1.8344\"", "\[Times]", 
              SuperscriptBox["10", "\"-9\""]}], 1.8344019294353344`*^-9, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"2.062\"", "\[Times]", 
              SuperscriptBox["10", "\"-9\""]}], 2.06201779376521*^-9, 
            AutoDelete -> True]}], "}"}], NumberForm[#, 5]& ]},
     "RowDefault"], TextForm]], "InlineText"],
  Text[
   Row[{
     Style["Reduced \!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) values:", Bold],
      " ", 
     NumberForm[{1.4433609965995886`*^-6, 1.5409407535999658`*^-9, 
      2.3263217683091867`*^-9, 1.8344019294353344`*^-9, 2.06201779376521*^-9},
       5]}]]]], "Output",
 CellChangeTimes->{
  3.752320407948081*^9, 3.7523205676106863`*^9, 3.752322565252533*^9, {
   3.7523226061586514`*^9, 3.7523226884953136`*^9}, 3.7523227945263977`*^9, 
   3.752322869194913*^9, 3.752322921673595*^9, 3.752323033395369*^9, {
   3.75232306464464*^9, 3.752323077079276*^9}, 3.75232319888958*^9, {
   3.752323286629418*^9, 3.752323309892489*^9}, {3.7523235282957993`*^9, 
   3.7523235842181997`*^9}, {3.7523240498940687`*^9, 
   3.7523240596155853`*^9}, {3.752324211882804*^9, 3.752324234126001*^9}, 
   3.7523243572785997`*^9, 3.752324717089819*^9, {3.752324749344965*^9, 
   3.7523247648265142`*^9}, {3.752324924790785*^9, 3.752324945083747*^9}, 
   3.752325114204612*^9, 3.752325147958848*^9, {3.752325261593741*^9, 
   3.752325269007924*^9}, 3.752325579755866*^9, 3.752325692138822*^9, 
   3.7523257594710197`*^9, {3.752325801980692*^9, 3.752325821773622*^9}, 
   3.75232587140527*^9, 3.752344168146637*^9, {3.752345462012429*^9, 
   3.752345483349168*^9}, 3.75234562784304*^9, {3.752345666531226*^9, 
   3.7523457171497517`*^9}, {3.752345783392747*^9, 3.752345799156814*^9}, 
   3.752345841452517*^9, 3.752345965150894*^9, {3.752346299572563*^9, 
   3.752346323065484*^9}, {3.752346784510931*^9, 3.752346832314665*^9}, 
   3.752434550321247*^9, 3.7524358328692837`*^9, 3.752436277496244*^9, 
   3.7524369058856077`*^9}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    TemplateBox[{
     StyleBox["\"The probability of getting this \\!\\(\\*SuperscriptBox[\\(\
\[Chi]\\), \\(2\\)]\\):\"", Bold, StripOnInput -> False],"\" P = \"",
      RowBox[{"{", 
        RowBox[{
         "1.`", ",", "1.`", ",", "1.`", ",", "1.0000000000000002`", ",", 
          "0.9999999999999998`"}], "}"}]},
     "RowDefault"], TextForm]], "InlineText"],
  Text[
   Row[{
     Style[
     "The probability of getting this \!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\
\):", Bold], " P = ", {1., 1., 1., 1.0000000000000002`, 
     0.9999999999999998}}]]]], "Output",
 CellChangeTimes->{
  3.752320407948081*^9, 3.7523205676106863`*^9, 3.752322565252533*^9, {
   3.7523226061586514`*^9, 3.7523226884953136`*^9}, 3.7523227945263977`*^9, 
   3.752322869194913*^9, 3.752322921673595*^9, 3.752323033395369*^9, {
   3.75232306464464*^9, 3.752323077079276*^9}, 3.75232319888958*^9, {
   3.752323286629418*^9, 3.752323309892489*^9}, {3.7523235282957993`*^9, 
   3.7523235842181997`*^9}, {3.7523240498940687`*^9, 
   3.7523240596155853`*^9}, {3.752324211882804*^9, 3.752324234126001*^9}, 
   3.7523243572785997`*^9, 3.752324717089819*^9, {3.752324749344965*^9, 
   3.7523247648265142`*^9}, {3.752324924790785*^9, 3.752324945083747*^9}, 
   3.752325114204612*^9, 3.752325147958848*^9, {3.752325261593741*^9, 
   3.752325269007924*^9}, 3.752325579755866*^9, 3.752325692138822*^9, 
   3.7523257594710197`*^9, {3.752325801980692*^9, 3.752325821773622*^9}, 
   3.75232587140527*^9, 3.752344168146637*^9, {3.752345462012429*^9, 
   3.752345483349168*^9}, 3.75234562784304*^9, {3.752345666531226*^9, 
   3.7523457171497517`*^9}, {3.752345783392747*^9, 3.752345799156814*^9}, 
   3.752345841452517*^9, 3.752345965150894*^9, {3.752346299572563*^9, 
   3.752346323065484*^9}, {3.752346784510931*^9, 3.752346832314665*^9}, 
   3.752434550321247*^9, 3.7524358328692837`*^9, 3.752436277496244*^9, 
   3.752436905886928*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Get", " ", "rid", " ", "of", " ", "bad", " ", "slopes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"newSlopes", " ", "=", " ", 
     RowBox[{"Delete", "[", 
      RowBox[{"slopes", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"new\[Sigma]Slopes", " ", "=", " ", 
     RowBox[{"Delete", "[", 
      RowBox[{"\[Sigma]slopes", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Calculate", " ", "the", " ", "periods"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"periods", " ", "=", " ", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"truePeriod", "[", 
        RowBox[{"slopes", ",", " ", "periodGuess"}], "]"}], ",", "20"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]periods", " ", "=", " ", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"\[Sigma]truePeriod", "[", 
        RowBox[{"slopes", ",", " ", "periodGuess", ",", "\[Sigma]slopes"}], 
        "]"}], ",", "20"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Compute", " ", "weighted", " ", "data"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wdata", " ", "=", " ", 
     RowBox[{"WeightedData", "[", 
      RowBox[{"periods", ",", " ", "\[Sigma]periods"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"meanPeriod1", " ", "=", " ", 
     RowBox[{"Mean", "[", "wdata", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]meanPeriod1", " ", "=", " ", 
     RowBox[{"StandardDeviation", "[", "wdata", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Mean Period:\>\"", ",", " ", "Bold"}], "]"}], ",", 
       "\"\< \>\"", ",", " ", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"meanPeriod", ",", "15"}], "]"}]}], "}"}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Error on Mean Period:\>\"", ",", " ", "Bold"}], "]"}], 
       ",", "\"\< \>\"", ",", " ", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"\[Sigma]meanPeriod", ",", "15"}], "]"}]}], "}"}], "]"}], 
    "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.752344415950378*^9, 3.7523444963233547`*^9}, 
   3.752346003193124*^9, {3.7524343235367928`*^9, 3.752434326708432*^9}, {
   3.752434492332118*^9, 3.7524344934824677`*^9}, {3.7524356788107357`*^9, 
   3.752435691307747*^9}, {3.752435760900734*^9, 3.752435762036005*^9}, {
   3.752436268145644*^9, 3.75243626910349*^9}}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    TemplateBox[{
     StyleBox["\"Mean Period:\"", Bold, StripOnInput -> False],"\" \"",TagBox[
      
       InterpretationBox[
       "\"0.0337555361017322\"", 
        0.03375553610173218985205012322009083482`19.522878745280337, 
        AutoDelete -> True], NumberForm[#, 15]& ]},
     "RowDefault"], TextForm]], "InlineText"],
  Text[
   Row[{
     Style["Mean Period:", Bold], " ", 
     NumberForm[
     0.03375553610173218985205012322009083482`19.522878745280337, 
      15]}]]]], "Output",
 CellChangeTimes->{{3.752345999582511*^9, 3.752346004687831*^9}, 
   3.7524345545236063`*^9, 3.752435836668152*^9, {3.752436269993431*^9, 
   3.752436280432476*^9}, 3.7524369101938887`*^9}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    TemplateBox[{
     StyleBox["\"Error on Mean Period:\"", Bold, StripOnInput -> False],
      "\" \"",TagBox[
       InterpretationBox[
        RowBox[{"\"2.1883515631\"", "\[Times]", 
          SuperscriptBox["10", "\"-10\""]}], 
        2.1883515631141226486079684861`11.117379955187904*^-10, AutoDelete -> 
        True], NumberForm[#, 15]& ]},
     "RowDefault"], TextForm]], "InlineText"],
  Text[
   Row[{
     Style["Error on Mean Period:", Bold], " ", 
     NumberForm[
     2.1883515631141226486079684861`11.117379955187904*^-10, 
      15]}]]]], "Output",
 CellChangeTimes->{{3.752345999582511*^9, 3.752346004687831*^9}, 
   3.7524345545236063`*^9, 3.752435836668152*^9, {3.752436269993431*^9, 
   3.752436280432476*^9}, 3.752436910195937*^9}]
}, Open  ]],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Crab 2", "Chapter",
 CellChangeTimes->{{3.7523481237420683`*^9, 3.752348124492652*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Estimated", " ", "period"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"periodGuess", " ", "=", " ", "0.0337555307"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Import", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"times", " ", "=", " ", 
     RowBox[{"ReadList", "[", 
      RowBox[{"\"\<crab2times.txt\>\"", ",", " ", "Number"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"remainders", "=", " ", 
     RowBox[{"ReadList", "[", 
      RowBox[{"\"\<crab2remainders.txt\>\"", ",", " ", "Number"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", " ", "=", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"times", ",", " ", "remainders"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"data", ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
     RowBox[{"Frame", "->", "True"}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", "700"}], ",", " ", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", " ", "Thick"}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7523481266603737`*^9, 3.7523481349744043`*^9}, {
  3.752348351210072*^9, 3.752348377563385*^9}, {3.7524336245205517`*^9, 
  3.752433675142789*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[1, 0, 0], PointSize[0.011000000000000001`], Thickness[Large], 
     PointBox[CompressedData["
1:eJwd0nkwlGEcwPHVYSZHxpWajK1cOSrXriPmoawlMwaNWrX+wBJG0dBo1lbs
xmCwcubcdabkaFv3rjCjJTlmMEymDM3QuEsZVOr388c773zmed/3+T7P+5wN
ifEPO0ShUOhw4T1lRbesYuyHW5RbwGf+RAxxUSnqRa/J9mlU80Ry38VkEV3L
NU9aihAQz/k6VRH4SJC+aI+aTnSaTK3Rr03Ve7K+ZZNVv/ob6L28J/dy2Lkw
zuShUw1pY7G0AiLs7xSjpyhFl2icQtJhYKZAey479w6rlIK91tCCAQZtXamC
pKyYaYnBxw9Hn0x4KAZn2aNX1p2jGZrXoc8mCJ2sqxbSIIslJcXfk9HjH8TR
fGceoaZY1KOHlYaSFLSn8P35kYP3OfOnxAYZ0Gu5hWZs7gerLQtJok6VXiV4
9FpPAHUjF55Xd0XfOl2r2vanANwYig5clfH7ZM9hPcbpB14wnt0cLoW+xia0
rxNrq1peQdjCi5PodU5E3/aCGPZDtIte0ZYon0kOJhSKFbUKXJcR4jrwOB7c
4o7u33gQkm+YRLbPW0Why2O6jDx8U0lN7Bsh+raCJe5yygRbt6K5Wz7WdINn
0C/5hP7arOh9p59PVKaZlGrw75+Rc3FGRdDfaowuYsqWObQS2L8r3miB3Y7h
qFc5sbV9G4vuap7YfWkgJmZs20I0V/4vtCWOAX3SbrRVx0C+g/wuma62m0cP
TDLS+r9wychHqXINmJd9RzkvXgC2s0TrbjYMukvTYT6JH1qNn9MtVAjB9AS0
fJwp+LWTC+errQytSe/VIn8LSHg4vR/txMtkvNArhvPZvoT21jg6tXmuDHrt
1WvBnSzTtiGmCNbbboP21xuvOmZSCb0OLLRp5Pv6xbRw6O14hJbQPHKLZxLg
vJhVo0t9kiNmNPiwn52D6I1Z1ivNC2kw7riOzhorj74amQ29Xdp12NukYFiw
sdfJEZ3i7zolDSuA/3v5JtryxNyQb2Ak+Q+CBb/x
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{5.049542610583125*^9, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->700,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{5.04954310537*^9, 5.04957477173*^9}, {0, 0.033493329167}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.752348153548046*^9, {3.752348354695959*^9, 3.752348379186158*^9}, 
   3.752434566244508*^9, 3.752435451728469*^9, 3.752435844471168*^9, 
   3.7524362833773623`*^9, 3.7524369184471703`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Separate", " ", "data", " ", "into", " ", "full", " ", "periods"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"peaksIdxs", " ", "=", " ", 
     RowBox[{
      RowBox[{"FindPeaks", "[", "remainders", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrependTo", "[", 
     RowBox[{"peaksIdxs", ",", "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sepData", " ", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"peaksIdxs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ";;", " ", 
          RowBox[{"peaksIdxs", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "@", "peaksIdxs"}], " ", "-", " ", "1"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "each", " ", "period"}], ",", " ", 
     RowBox[{"find", " ", "slopes"}], ",", " ", 
     RowBox[{"errors", " ", "and", " ", "the", " ", "residuals"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slopes", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"LinearModelFit", "[", 
          RowBox[{
           RowBox[{"sepData", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "x", ",", "x"}], "]"}], "[", 
         "\"\<BestFitParameters\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "sepData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]slopes", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"LinearModelFit", "[", 
          RowBox[{
           RowBox[{"sepData", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "x", ",", "x"}], "]"}], "[", 
         "\"\<ParameterErrors\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "sepData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"residuals", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LinearModelFit", "[", 
         RowBox[{
          RowBox[{"sepData", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "x", ",", "x"}], "]"}], "[", 
        "\"\<FitResiduals\>\"", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "sepData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fit", " ", "statistics"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nDof", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"sepData", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "-", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", " ", 
         RowBox[{"Length", "@", "sepData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]sq", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Total", "[", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"residuals", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ")"}], "2"], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "residuals"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["E", 
            RowBox[{
             RowBox[{"-", "\[Chi]s"}], "/", "2"}]], "*", 
           SuperscriptBox["\[Chi]s", 
            RowBox[{
             FractionBox[
              RowBox[{"nDof", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "2"], "-", "1"}]]}], 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"nDof", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "2"}]], "*", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             RowBox[{"nDof", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}]], ",", 
         RowBox[{"{", 
          RowBox[{"\[Chi]s", ",", 
           RowBox[{"\[Chi]sq", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "Infinity"}], "}"}]}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", " ", 
         RowBox[{"Length", "@", "\[Chi]sq"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Test", " ", "plot"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lm", " ", "=", " ", 
     RowBox[{"LinearModelFit", "[", 
      RowBox[{
       RowBox[{"sepData", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "x", ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xdata", " ", "=", " ", 
     RowBox[{
      RowBox[{"sepData", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"sepData", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}], ",", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"lm", "[", "x", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Min", "[", "xdata", "]"}], ",", " ", 
         RowBox[{"Max", "[", "xdata", "]"}]}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", " ", "Thick"}], "}"}]}]}], "]"}], ",", " ", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", "700"}], ",", " ", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Example Plot\>\""}], ",", " ", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "20", "]"}]}], ",", " ", 
     RowBox[{"FrameTicksStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", "20", "]"}], ",", 
        RowBox[{"Directive", "[", "12", "]"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Outputting", " ", "the", " ", "results"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) values:\>\"", ",", " ",
          "Bold"}], "]"}], ",", "\"\< \>\"", ",", " ", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"\[Chi]sq", ",", "5"}], "]"}]}], "}"}], "]"}], "]"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<Reduced \!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) values:\>\"", 
         ",", " ", "Bold"}], "]"}], ",", "\"\< \>\"", ",", " ", 
       RowBox[{"NumberForm", "[", 
        RowBox[{
         FractionBox["\[Chi]sq", "nDof"], ",", "5"}], "]"}]}], "}"}], "]"}], 
    "]"}], "  ", "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<The probability of getting this \!\(\*SuperscriptBox[\(\[Chi]\), \
\(2\)]\):\>\"", ",", " ", "Bold"}], "]"}], ",", "\"\< P = \>\"", ",", "p"}], 
      "}"}], "]"}], "]"}], " "}]}]], "Input",
 CellChangeTimes->{{3.752348150133596*^9, 3.752348150433989*^9}, {
   3.752348248002655*^9, 3.752348277782058*^9}, {3.752434672880821*^9, 
   3.752434785063417*^9}, 3.752434845327425*^9, {3.752435221487142*^9, 
   3.752435243082712*^9}, {3.752435372338294*^9, 3.752435488193084*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {GrayLevel[0], PointSize[0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{5.04956349121*^9, 0.000654660347207}, {5.04956409125*^9, 
       0.00363026667599}, {5.04956469129*^9, 0.00656009663759}, {
       5.0495652913*^9, 0.00949969161315}, {5.0495658913*^9, 
       0.0125508664837}, {5.04956649114*^9, 0.0155173520198}, {
       5.04956709139*^9, 0.0185278283479}, {5.04956769143*^9, 
       0.0214738707728}, {5.0495682914*^9, 0.0245042930793}, {
       5.04956889144*^9, 0.0274770383851}, {5.04956949145*^9, 
       0.030547286742}, {5.04957009149*^9, 
       0.033493329167}}]}, {}}, {}, {}, {{}, {}}}, {{{}, {}, 
     {RGBColor[1, 0, 0], Thickness[Large], Opacity[1.], 
      LineBox[CompressedData["
1:eJw10X1Mk1cUBvBOhSDihkHBVcFWmLHMjyqIlAAPBgZMkCKgUzOxTDEV46pA
I2iITKUwMAJWLALS96VlkDqdxmqVGVNFERhTMVNUSFc/QvwMHwEUJGEs9/SP
N/f95Z77nJN7xT+pktKnCASCdZPf/+uVHwNOGe4Prpn89RQ3RiLQmuxwqHk8
Ehd9sx1WxKyPwu9vzQ6b9oxFgc8J0pFDmuKjceykrNJRnzwQi7QOVJF/KwhJ
gFtofC15nnpnCsL2ezSQUw71bEN3y3d/MOeHzYxNR9qHBAvte4xrMnBL5Wxl
ttps8/aizFnSyhzRZ2jORMjo6APaz0gyqvHXLf4pWVO+PwdtnPk51dsChQdR
90z9lszdHM7Dm8V1g9RPvjkxH14J9WPMIh+h/heI7m+camTz1cldj0C3I2sG
sz1q9dajeLMhfDazokbbUYCFPvb5zKKo4FWFaBt770f100sLihAX0LiU2Xp0
y+CvCMm/t4ryvZ9El8BJYghn5na3W47B0pgQ4zjvtPA4Hoemy5kFLQNZpehc
4r+J8qol+8ogW7FFQfNsD5hfjiK3NCWzNPl5czkuRXruo/wzbbknEFcalMvc
P1Lsq8WNIKfD1M+k6dZi7mVTMfUrXFR2EvaYP0+QM/XBFTgSdKCa+YIlqa8C
WpnRQP3c/j19CiUe9Wcpv+irNTqkfp9iZk5UHBjRoVb783Xmsugb+ko0yVbf
ofsoDP3hNCKHMv6m+i7tlCpcKlA/Yo6Ql5qqMJG5zEbziu8oqnE1O6mXee/U
f1xrEP/Qr4/y4d1cg1bnex+p3uCacwYX5S8m6L28OkW1UA8ZXerZvK86u2rR
cO6hO7P15tnDeljDuuYyb3o5ew4Hs6RYzCzyGFBx8PRvlDAr2q/d5tCq7CDH
pga2cMht6CdLB8/f5dDjJ/NnFgiN7RwMC9rJF3Ydf8BBOuf9t8yfXLb3cFgr
kC5jroxxG+IwHp5CLurWDHM4l5dDVqq++MjB/bOVHKEbGeXQNbx+OfPrXvsE
hx3vsqTMwZrLM/jJ+SvJi4XSmTzuKq+TXc6bvuTh3zttBfOTR/pZPPrtFeT8
b4q9eNQtaCIrr037mkdyqo2cuO6QkMeV7kUr6b7U2d48lMI4svv0Ph8ews0q
8qeaXSIeHTot+bX0lZhH3mMLufV2qi+P/wANYyxE
       "]]}}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{5.049563388080626*^9, 0},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  FrameTicksStyle->{
    Directive[20], 
    Directive[12]},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->700,
  LabelStyle->Directive[20],
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"Example Plot\"", TraditionalForm],
  PlotRange->{{5.04956349121*^9, 5.04957009149*^9}, {0, 0.033493329167}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.752348187976385*^9, {3.7523482525500526`*^9, 3.752348279559474*^9}, 
   3.752434587551503*^9, 3.7524346987940617`*^9, {3.7524347590916433`*^9, 
   3.7524347855586987`*^9}, 3.7524348462105503`*^9, {3.752435226537121*^9, 
   3.752435243855383*^9}, {3.752435395539662*^9, 3.752435491167428*^9}, 
   3.752435846913875*^9, 3.752436284943684*^9, 3.752436953467657*^9}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    TemplateBox[{
     StyleBox["\"\\!\\(\\*SuperscriptBox[\\(\[Chi]\\), \\(2\\)]\\) values:\"",
        Bold, StripOnInput -> False],"\" \"",TagBox[
       RowBox[{"{", 
         RowBox[{
           InterpretationBox[
            RowBox[{"\"2.4357\"", "\[Times]", 
              SuperscriptBox["10", "\"-6\""]}], 2.4357026188747214`*^-6, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"2.59\"", "\[Times]", 
              SuperscriptBox["10", "\"-8\""]}], 2.589988856110162*^-8, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"2.5895\"", "\[Times]", 
              SuperscriptBox["10", "\"-8\""]}], 2.5894869569330703`*^-8, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"1.6735\"", "\[Times]", 
              SuperscriptBox["10", "\"-8\""]}], 1.6734532791291877`*^-8, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"4.712\"", "\[Times]", 
              SuperscriptBox["10", "\"-9\""]}], 4.711988956168971*^-9, 
            AutoDelete -> True]}], "}"}], NumberForm[#, 5]& ]},
     "RowDefault"], TextForm]], "InlineText"],
  Text[
   Row[{
     Style["\!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) values:", Bold], " ", 
     NumberForm[{2.4357026188747214`*^-6, 2.589988856110162*^-8, 
      2.5894869569330703`*^-8, 1.6734532791291877`*^-8, 
      4.711988956168971*^-9}, 5]}]]]], "Output",
 CellChangeTimes->{
  3.752348187976385*^9, {3.7523482525500526`*^9, 3.752348279559474*^9}, 
   3.752434587551503*^9, 3.7524346987940617`*^9, {3.7524347590916433`*^9, 
   3.7524347855586987`*^9}, 3.7524348462105503`*^9, {3.752435226537121*^9, 
   3.752435243855383*^9}, {3.752435395539662*^9, 3.752435491167428*^9}, 
   3.752435846913875*^9, 3.752436284943684*^9, 3.752436953473116*^9}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    TemplateBox[{
     StyleBox["\"Reduced \\!\\(\\*SuperscriptBox[\\(\[Chi]\\), \\(2\\)]\\) \
values:\"", Bold, StripOnInput -> False],"\" \"",TagBox[
       RowBox[{"{", 
         RowBox[{
           InterpretationBox[
            RowBox[{"\"2.7063\"", "\[Times]", 
              SuperscriptBox["10", "\"-7\""]}], 2.706336243194135*^-7, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"2.59\"", "\[Times]", 
              SuperscriptBox["10", "\"-9\""]}], 2.5899888561101624`*^-9, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"2.8772\"", "\[Times]", 
              SuperscriptBox["10", "\"-9\""]}], 2.8772077299256334`*^-9, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"1.6735\"", "\[Times]", 
              SuperscriptBox["10", "\"-9\""]}], 1.6734532791291877`*^-9, 
            AutoDelete -> True], ",", 
           InterpretationBox[
            RowBox[{"\"9.424\"", "\[Times]", 
              SuperscriptBox["10", "\"-10\""]}], 9.423977912337941*^-10, 
            AutoDelete -> True]}], "}"}], NumberForm[#, 5]& ]},
     "RowDefault"], TextForm]], "InlineText"],
  Text[
   Row[{
     Style["Reduced \!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\) values:", Bold],
      " ", 
     NumberForm[{2.706336243194135*^-7, 2.5899888561101624`*^-9, 
      2.8772077299256334`*^-9, 1.6734532791291877`*^-9, 
      9.423977912337941*^-10}, 5]}]]]], "Output",
 CellChangeTimes->{
  3.752348187976385*^9, {3.7523482525500526`*^9, 3.752348279559474*^9}, 
   3.752434587551503*^9, 3.7524346987940617`*^9, {3.7524347590916433`*^9, 
   3.7524347855586987`*^9}, 3.7524348462105503`*^9, {3.752435226537121*^9, 
   3.752435243855383*^9}, {3.752435395539662*^9, 3.752435491167428*^9}, 
   3.752435846913875*^9, 3.752436284943684*^9, 3.7524369534752703`*^9}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    TemplateBox[{
     StyleBox["\"The probability of getting this \\!\\(\\*SuperscriptBox[\\(\
\[Chi]\\), \\(2\\)]\\):\"", Bold, StripOnInput -> False],"\" P = \"",
      RowBox[{"{", 
        RowBox[{
         "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
          "0.9999999999999998`"}], "}"}]},
     "RowDefault"], TextForm]], "InlineText"],
  Text[
   Row[{
     Style[
     "The probability of getting this \!\(\*SuperscriptBox[\(\[Chi]\), \(2\)]\
\):", Bold], " P = ", {1., 1., 1., 1., 0.9999999999999998}}]]]], "Output",
 CellChangeTimes->{
  3.752348187976385*^9, {3.7523482525500526`*^9, 3.752348279559474*^9}, 
   3.752434587551503*^9, 3.7524346987940617`*^9, {3.7524347590916433`*^9, 
   3.7524347855586987`*^9}, 3.7524348462105503`*^9, {3.752435226537121*^9, 
   3.752435243855383*^9}, {3.752435395539662*^9, 3.752435491167428*^9}, 
   3.752435846913875*^9, 3.752436284943684*^9, 3.752436953476816*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Get", " ", "rid", " ", "of", " ", "bad", " ", "slopes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"newSlopes", " ", "=", " ", 
     RowBox[{"Delete", "[", 
      RowBox[{"slopes", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"new\[Sigma]Slopes", " ", "=", " ", 
     RowBox[{"Delete", "[", 
      RowBox[{"\[Sigma]slopes", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Calculate", " ", "the", " ", "periods"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"periods", " ", "=", " ", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"truePeriod", "[", 
        RowBox[{"slopes", ",", " ", "periodGuess"}], "]"}], ",", "20"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]periods", " ", "=", " ", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"\[Sigma]truePeriod", "[", 
        RowBox[{"slopes", ",", "periodGuess", ",", "\[Sigma]slopes"}], "]"}], 
       ",", "20"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Compute", " ", "weighted", " ", "data"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wdata", " ", "=", " ", 
     RowBox[{"WeightedData", "[", 
      RowBox[{"periods", ",", " ", "\[Sigma]periods"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"meanPeriod2", " ", "=", " ", 
     RowBox[{"Mean", "[", "wdata", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]meanPeriod2", " ", "=", " ", 
     RowBox[{"StandardDeviation", "[", "wdata", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Mean Period:\>\"", ",", " ", "Bold"}], "]"}], ",", 
       "\"\< \>\"", ",", " ", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"meanPeriod", ",", "15"}], "]"}]}], "}"}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Error on Mean Period:\>\"", ",", " ", "Bold"}], "]"}], 
       ",", "\"\< \>\"", ",", " ", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"\[Sigma]meanPeriod", ",", "15"}], "]"}]}], "}"}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.752348224333249*^9, 3.752348224560746*^9}, {
  3.752434529702278*^9, 3.752434536729637*^9}, {3.75243552283902*^9, 
  3.7524355381541*^9}, {3.752435597698288*^9, 3.752435669394346*^9}, {
  3.7524362605487432`*^9, 3.7524362613506203`*^9}}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    TemplateBox[{
     StyleBox["\"Mean Period:\"", Bold, StripOnInput -> False],"\" \"",TagBox[
      
       InterpretationBox[
       "\"0.0337555361017322\"", 
        0.03375553610173218985205012322009083482`19.522878745280337, 
        AutoDelete -> True], NumberForm[#, 15]& ]},
     "RowDefault"], TextForm]], "InlineText"],
  Text[
   Row[{
     Style["Mean Period:", Bold], " ", 
     NumberForm[
     0.03375553610173218985205012322009083482`19.522878745280337, 
      15]}]]]], "Output",
 CellChangeTimes->{3.752348225790909*^9, 3.752435849565106*^9, 
  3.752436285737172*^9, 3.752436963107642*^9}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    TemplateBox[{
     StyleBox["\"Error on Mean Period:\"", Bold, StripOnInput -> False],
      "\" \"",TagBox[
       InterpretationBox[
        RowBox[{"\"2.1883515631\"", "\[Times]", 
          SuperscriptBox["10", "\"-10\""]}], 
        2.1883515631141226486079684861`11.117379955187904*^-10, AutoDelete -> 
        True], NumberForm[#, 15]& ]},
     "RowDefault"], TextForm]], "InlineText"],
  Text[
   Row[{
     Style["Error on Mean Period:", Bold], " ", 
     NumberForm[
     2.1883515631141226486079684861`11.117379955187904*^-10, 
      15]}]]]], "Output",
 CellChangeTimes->{3.752348225790909*^9, 3.752435849565106*^9, 
  3.752436285737172*^9, 3.752436963109597*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative and Quantities of Interest", "Chapter",
 CellChangeTimes->{{3.752435950576461*^9, 3.752435959167329*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Constants", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"c", " ", "=", " ", 
     RowBox[{"UnitConvert", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", "\"\<SpeedOfLight\>\"", "]"}], ",", "1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Fromulas", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"age", "[", 
      RowBox[{"p_", ",", "pder_"}], "]"}], ":=", 
     FractionBox["p", 
      RowBox[{"2", "*", "pder"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", "[", 
     RowBox[{"I_", ",", "R_", ",", "\[Alpha]_", ",", "p_", ",", "pder_"}], 
     "]"}], ":=", 
    SqrtBox[
     RowBox[{
      FractionBox[
       RowBox[{"3", "*", 
        SuperscriptBox["c", "3"], "*", 
        StyleBox["I",
         FontSlant->"Italic"]}], 
       RowBox[{"8", "*", 
        SuperscriptBox["\[Pi]", "2"], "*", 
        SuperscriptBox["R", "6"], "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Sin", "[", "\[Alpha]", "]"}], ")"}], "2"]}]], "*", "p", 
      "*", "pder"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.7524364164010763`*^9, 3.752436422033786*^9}, {
  3.75243662844788*^9, 3.7524366522672777`*^9}, {3.752436980295855*^9, 
  3.7524370189978867`*^9}, {3.752437236145702*^9, 3.7524372584367113`*^9}, {
  3.7524373393207197`*^9, 3.752437370888426*^9}, {3.7524374045236683`*^9, 
  3.752437416795445*^9}, {3.752437461805855*^9, 3.75243749657165*^9}, {
  3.7524377504287987`*^9, 3.7524378204129753`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Frequency", " ", "Derivative"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Delta]t", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"58443.968055545330040", "-", "58435.969024813132347"}], ")"}], 
     "*", "86400"}]}], "\[IndentingNewLine]", 
   RowBox[{"\[Delta]p", " ", "=", " ", 
    RowBox[{"meanPeriod2", "-", "meanPeriod1"}]}], "\[IndentingNewLine]", 
   RowBox[{
    OverscriptBox["p", "."], " ", "=", " ", 
    FractionBox["\[Delta]p", "\[Delta]t"]}]}]}]], "Input",
 CellChangeTimes->{{3.752435960199623*^9, 3.7524359897437077`*^9}, {
   3.752436052344782*^9, 3.752436073504382*^9}, 3.7524361137114477`*^9, {
   3.752436187363735*^9, 3.752436245461466*^9}, {3.752436290945655*^9, 
   3.752436431650057*^9}, {3.752436657668826*^9, 3.752436718159793*^9}, {
   3.752437128762405*^9, 3.7524371295090437`*^9}, {3.752437198744937*^9, 
   3.752437204624308*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  "691116.25526188067519999999999999999999994236`15.602007369682864"}]], \
"Output",
 CellChangeTimes->{{3.752436391369669*^9, 3.752436406871924*^9}, 
   3.752436720116851*^9, 3.7524371300922527`*^9}],

Cell[BoxData["2.894441121311107797751323218654`14.155070321378231*^-7"], \
"Output",
 CellChangeTimes->{{3.752436391369669*^9, 3.752436406871924*^9}, 
   3.752436720116851*^9, 3.752437130093443*^9}],

Cell[BoxData[
 RowBox[{"-", 
  "4.1880669124391149025122966`14.139822732844628*^-13"}]], "Output",
 CellChangeTimes->{{3.752436391369669*^9, 3.752436406871924*^9}, 
   3.752436720116851*^9, 3.7524371300944643`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1869, 1052},
WindowMargins->{{-50, Automatic}, {Automatic, 29}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 101, 1, 93, "Title"],
Cell[684, 25, 1679, 40, 267, "Input"],
Cell[CellGroupData[{
Cell[2388, 69, 193, 3, 66, "Chapter"],
Cell[CellGroupData[{
Cell[2606, 76, 2051, 44, 209, "Input"],
Cell[4660, 122, 2738, 57, 437, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7435, 184, 10181, 253, 698, "Input"],
Cell[17619, 439, 4578, 88, 462, "Output"],
Cell[22200, 529, 2802, 53, 40, "Output"],
Cell[25005, 584, 2885, 55, 40, "Output"],
Cell[27893, 641, 1966, 36, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29896, 682, 2885, 72, 353, "Input"],
Cell[32784, 756, 748, 19, 30, "Output"],
Cell[33535, 777, 815, 20, 34, "Output"]
}, Open  ]],
Cell[34365, 800, 271, 9, 10, "Text"],
Cell[34639, 811, 271, 9, 10, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34947, 825, 93, 1, 66, "Chapter"],
Cell[CellGroupData[{
Cell[35065, 830, 1446, 36, 190, "Input"],
Cell[36514, 868, 2597, 55, 431, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39148, 928, 8566, 232, 699, "Input"],
Cell[47717, 1162, 3689, 75, 457, "Output"],
Cell[51409, 1239, 1915, 40, 40, "Output"],
Cell[53327, 1281, 1936, 41, 40, "Output"],
Cell[55266, 1324, 979, 21, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56282, 1350, 2798, 71, 352, "Input"],
Cell[59083, 1423, 669, 18, 30, "Output"],
Cell[59755, 1443, 738, 19, 34, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60542, 1468, 122, 1, 66, "Chapter"],
Cell[60667, 1471, 1573, 40, 227, "Input"],
Cell[CellGroupData[{
Cell[62265, 1515, 970, 20, 138, "Input"],
Cell[63238, 1537, 229, 5, 30, "Output"],
Cell[63470, 1544, 198, 3, 34, "Output"],
Cell[63671, 1549, 214, 4, 34, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

