(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31173,        730]
NotebookOptionsPosition[     30698,        710]
NotebookOutlinePosition[     31035,        725]
CellTagsIndexPosition[     30992,        722]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Frequency vs Time Delay - Too Noisy to Measure", "Title",
 CellChangeTimes->{{3.752924978658222*^9, 3.752924988256068*^9}, {
  3.753192803451981*^9, 3.753192809443618*^9}, {3.753195284575696*^9, 
  3.753195291027438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Preliminaries", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rootDir", " ", "=", " ", 
     RowBox[{"ParentDirectory", "[", 
      RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rowDir", " ", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
       "rootDir", ",", " ", "\"\<ResultPictures1\>\"", ",", 
        "\"\<RowGrids\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"spectrumFitsDir", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
       "rootDir", ",", " ", "\"\<ResultPictures1\>\"", ",", 
        "\"\<SpectrumFits\>\""}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
       "rootDir", ",", "\"\<Data\>\"", ",", " ", "\"\<FreqDelay\>\""}], "}"}],
       "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pulsarName", " ", "=", " ", "\"\<B2111+46_w4\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Select", " ", "region", " ", "of", " ", "data"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"regionSelect", "[", 
      RowBox[{"data_", ",", "x1_", ",", "x2_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Select", "[", 
      RowBox[{"data", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"x1", "<", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", "x2"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ">", "0"}]}], "&"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Full", " ", "Width", " ", "Half", " ", "Maximum"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"half", "[", "data_", "]"}], ":=", 
     RowBox[{"Nearest", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Rule]", "i"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"0.5", "*", 
        RowBox[{"Max", "[", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", "1"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FWHM", "[", 
      RowBox[{"data_", ",", "half_"}], "]"}], ":=", 
     RowBox[{"First", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"half", ",", "1"}], "]"}], "]"}], "-", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"First", "[", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"Max", "[", 
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
              "]"}], ",", "1"}], "]"}], "]"}]}], ")"}], "*", "2"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7529249893248377`*^9, 3.752925065905394*^9}, 
   3.752925128660344*^9, {3.752934293252906*^9, 3.752934350662788*^9}, {
   3.752934629264904*^9, 3.752934629434833*^9}, {3.752934765137697*^9, 
   3.752934800309495*^9}, {3.752934932777609*^9, 3.7529349883093452`*^9}, {
   3.752935069571577*^9, 3.752935103142518*^9}, {3.752935149586793*^9, 
   3.752935151621832*^9}, {3.7529353744256573`*^9, 3.7529353765030193`*^9}, {
   3.7529354672040453`*^9, 3.752935603486479*^9}, 3.752935738786257*^9, {
   3.752936447146809*^9, 3.752936453965015*^9}, {3.752937001254075*^9, 
   3.75293703365477*^9}, {3.752937088287678*^9, 3.752937092528594*^9}, {
   3.7529371391762114`*^9, 3.7529371863746243`*^9}, {3.7529372813783293`*^9, 
   3.752937325978828*^9}, {3.752937360093705*^9, 3.752937389155902*^9}, {
   3.7529374292837887`*^9, 3.752937505941193*^9}, {3.7529376865453672`*^9, 
   3.752937698363738*^9}, {3.752937903193671*^9, 3.752937908819594*^9}, {
   3.7529381513016148`*^9, 3.75293825733877*^9}, {3.7529385046145687`*^9, 
   3.752938512581032*^9}, 3.7529387210992517`*^9, {3.752939271554525*^9, 
   3.752939304993924*^9}, {3.752939340308776*^9, 3.752939343637616*^9}, {
   3.752944833439858*^9, 3.752944834874404*^9}, {3.7529454503610773`*^9, 
   3.752945487607058*^9}, {3.752945519511327*^9, 3.752945564019518*^9}, {
   3.752947494367524*^9, 3.752947494800157*^9}, {3.752947571402169*^9, 
   3.752947574318825*^9}, {3.752952839351448*^9, 3.752952926396359*^9}, 
   3.75295302990662*^9, {3.753032039081451*^9, 3.753032102523694*^9}, {
   3.753032133804903*^9, 3.753032165775112*^9}, {3.7530323410259123`*^9, 
   3.75303234294864*^9}, {3.7530324181574917`*^9, 3.753032445456665*^9}, {
   3.753032488257436*^9, 3.753032533709359*^9}, {3.7530326685852757`*^9, 
   3.753032687352861*^9}, {3.753043324404471*^9, 3.753043324534824*^9}, {
   3.753188212891041*^9, 3.7531882139287767`*^9}, 3.75318957778963*^9, {
   3.75319121434363*^9, 3.753191216301055*^9}, 3.7531914460927553`*^9, 
   3.753192400374881*^9, 3.753192689397711*^9, 3.753192854239029*^9, 
   3.7531936108178177`*^9, 3.7531946300910263`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Importing", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"raw", " ", "=", " ", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"pulsarName", " ", "<>", " ", "\"\<_raw.txt\>\""}], ",", " ", 
       "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"time", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Import", " ", "[", 
       RowBox[{
        RowBox[{"pulsarName", " ", "<>", "\"\<_time.txt\>\""}], ",", " ", 
        "\"\<Table\>\""}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"freq", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"pulsarName", " ", "<>", " ", "\"\<_freq.txt\>\""}], ",", 
        " ", "\"\<Table\>\""}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"data", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"time", ",", 
          RowBox[{"raw", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "raw"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.752925067051539*^9, {3.7529250994989033`*^9, 3.752925125127791*^9}, {
   3.752925173963171*^9, 3.752925233132846*^9}, {3.752925277739305*^9, 
   3.75292548366094*^9}, {3.752925519992831*^9, 3.7529255226492777`*^9}, {
   3.7529255724382277`*^9, 3.752925690853545*^9}, {3.752926246629719*^9, 
   3.752926311177004*^9}, {3.752926717765685*^9, 3.752926751081002*^9}, {
   3.7529267973103247`*^9, 3.7529269254762487`*^9}, {3.752927039714856*^9, 
   3.752927058599856*^9}, {3.752927386834786*^9, 3.752927461646277*^9}, {
   3.7529275819216957`*^9, 3.752927595861533*^9}, {3.752928505365897*^9, 
   3.752928576695064*^9}, {3.752928709096882*^9, 3.7529287855134687`*^9}, {
   3.7529288726820507`*^9, 3.7529288745753613`*^9}, {3.752928910399292*^9, 
   3.752928919226755*^9}, {3.752932157066539*^9, 3.752932195188161*^9}, 
   3.7529325987928867`*^9, {3.752932632522472*^9, 3.752932710192586*^9}, {
   3.752932757743726*^9, 3.752932757904664*^9}, {3.752932892420786*^9, 
   3.752932922365748*^9}, {3.7529329556936913`*^9, 3.752932999515464*^9}, {
   3.752933110603037*^9, 3.752933127352089*^9}, {3.752933158477581*^9, 
   3.7529332014220963`*^9}, {3.752933360325844*^9, 3.752933440030842*^9}, {
   3.752934325655386*^9, 3.7529343428186493`*^9}, {3.752934405344892*^9, 
   3.7529344342999153`*^9}, {3.752934635356371*^9, 3.752934670219351*^9}, {
   3.752934733507718*^9, 3.7529347622566843`*^9}, {3.7529348119164762`*^9, 
   3.752934871543241*^9}, 3.7529349305620737`*^9, {3.752935110121148*^9, 
   3.752935155416135*^9}, {3.752935391057384*^9, 3.7529354398269367`*^9}, {
   3.7529355053674307`*^9, 3.7529355467177477`*^9}, 3.752935590591825*^9, {
   3.7529357150805264`*^9, 3.7529357424390078`*^9}, {3.7529361224022627`*^9, 
   3.752936150349557*^9}, {3.752936359165181*^9, 3.752936368524601*^9}, {
   3.7529364250477*^9, 3.752936430618424*^9}, {3.752936462622773*^9, 
   3.752936502043097*^9}, {3.752936600790894*^9, 3.752936740731577*^9}, {
   3.7529370482092876`*^9, 3.7529370560406933`*^9}, {3.7529371997601748`*^9, 
   3.752937269340169*^9}, {3.752937413553899*^9, 3.752937422284794*^9}, {
   3.752937512559976*^9, 3.75293753405831*^9}, {3.7529375655268393`*^9, 
   3.7529376624976587`*^9}, {3.752937722175722*^9, 3.7529378232472057`*^9}, {
   3.752937919952628*^9, 3.752937999863124*^9}, {3.752938057441354*^9, 
   3.75293806706161*^9}, {3.7529381237518272`*^9, 3.752938164364992*^9}, {
   3.752938228494578*^9, 3.752938228652108*^9}, {3.7529384991233788`*^9, 
   3.752938633774453*^9}, {3.752938693954493*^9, 3.7529388084153976`*^9}, {
   3.752938866028088*^9, 3.752938871568028*^9}, {3.752938902603965*^9, 
   3.752938981526024*^9}, {3.752939013243186*^9, 3.7529390146000347`*^9}, {
   3.7529390484768867`*^9, 3.752939087393832*^9}, {3.7529392502094097`*^9, 
   3.752939250781145*^9}, {3.7529393140211687`*^9, 3.752939362104602*^9}, {
   3.752939502598008*^9, 3.752939519970312*^9}, {3.752939560924878*^9, 
   3.752939594159484*^9}, {3.752939657753017*^9, 3.752939677422086*^9}, {
   3.752940110048806*^9, 3.752940120284195*^9}, 3.752953045996862*^9, {
   3.752955298224156*^9, 3.752955318431827*^9}, {3.753188219653914*^9, 
   3.7531882539101143`*^9}, {3.7531882937527637`*^9, 3.753188315272621*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Table", " ", "of", " ", "Raw", " ", "Plots"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"plots", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
         RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plots", " ", "=", " ", 
     RowBox[{"Partition", "[", 
      RowBox[{"plots", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"grid", " ", "=", " ", 
    RowBox[{"GraphicsGrid", "[", 
     RowBox[{"plots", ",", 
      RowBox[{"ImageSize", "\[Rule]", "1300"}], ",", " ", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"pulsarName", " ", "<>", " ", "\"\<\\n\>\""}]}], ",", " ", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"25", ",", "Bold"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"rowDir", ",", 
        RowBox[{"pulsarName", " ", "<>", " ", "\"\<.png\>\""}]}], "}"}], 
      "]"}], ",", "grid"}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.752940123658267*^9, 3.752940139794629*^9}, {
  3.752940234119275*^9, 3.7529402524685717`*^9}, {3.7529406249788427`*^9, 
  3.7529406356327*^9}, {3.752944434283564*^9, 3.7529444552165127`*^9}, {
  3.752944505188094*^9, 3.752944518514503*^9}, {3.752944558285673*^9, 
  3.752944571813684*^9}, {3.752945590406973*^9, 3.75294559920124*^9}, {
  3.7529457561577663`*^9, 3.752945788239491*^9}, {3.7529459837701797`*^9, 
  3.752945991076456*^9}, {3.752946025569772*^9, 3.7529460261102324`*^9}, {
  3.753031934374415*^9, 3.7530319382942743`*^9}, {3.753032017516345*^9, 
  3.753032037118601*^9}, {3.753032168202257*^9, 3.7530322409463797`*^9}, {
  3.7530323455649853`*^9, 3.753032347817643*^9}, {3.753032386790889*^9, 
  3.753032389393628*^9}, {3.753032541263906*^9, 3.753032583184536*^9}, {
  3.753189655033874*^9, 3.75318966079972*^9}, {3.753191243677826*^9, 
  3.753191244872464*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Eliminate", " ", "bad", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"filtData", " ", "=", " ", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"9", ";;", "28"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Find", " ", "where", " ", "the", " ", "FWHM", " ", "is", " ", "and", " ",
      "its", " ", "value"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"halfsPos", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"half", "[", 
        RowBox[{"filtData", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "filtData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"halfs", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"filtData", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"half", "[", 
           RowBox[{"filtData", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "filtData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fwhms", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"FWHM", "[", 
        RowBox[{
         RowBox[{"filtData", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"halfsPos", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "halfsPos"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Create", " ", "Table", " ", "of", " ", "plots", " ", "indicating", " ", 
     "this"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"filtPlots", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"filtData", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
           RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"halfs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
           
           RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "filtData"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"filtPlots", " ", "=", " ", 
     RowBox[{"Partition", "[", 
      RowBox[{"filtPlots", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{"filtPlots", ",", 
     RowBox[{"ImageSize", "\[Rule]", "1700"}], ",", " ", 
     RowBox[{
     "PlotLabel", "\[Rule]", 
      "\"\<Filtered Data - FWHF Position Indicated\>\""}], ",", " ", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"25", ",", "Bold"}], "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.752946037969932*^9, 3.7529461089867477`*^9}, {
   3.7529461409188843`*^9, 3.752946142936116*^9}, {3.752946193998579*^9, 
   3.7529463136184053`*^9}, {3.752946436078247*^9, 3.752946468063641*^9}, {
   3.7529465054538116`*^9, 3.752946509829976*^9}, {3.752946653419087*^9, 
   3.752946762640153*^9}, {3.752946812196233*^9, 3.752946956140012*^9}, {
   3.7529470420003767`*^9, 3.7529470692658463`*^9}, 3.752947128298656*^9, {
   3.752947199450667*^9, 3.752947276908409*^9}, {3.752947342482131*^9, 
   3.752947378085555*^9}, {3.752947409154112*^9, 3.752947443752643*^9}, {
   3.752947821239377*^9, 3.752947893417705*^9}, 3.75295299985386*^9, {
   3.752953069545466*^9, 3.7529531403126297`*^9}, {3.7531899404839497`*^9, 
   3.753189940726079*^9}, {3.7531899890488157`*^9, 3.753189991984601*^9}, {
   3.753190045126964*^9, 3.753190059166389*^9}, {3.753190100593421*^9, 
   3.75319010114782*^9}, {3.7531912971594677`*^9, 3.753191297827848*^9}, {
   3.753191341258707*^9, 3.7531913728109303`*^9}, {3.753191521101166*^9, 
   3.75319155807432*^9}, {3.75319160433764*^9, 3.753191606992251*^9}, {
   3.75319164782374*^9, 3.753191659752418*^9}, {3.753191692983028*^9, 
   3.75319178252769*^9}, {3.7531918268061237`*^9, 3.753191871921762*^9}, {
   3.7531919149254*^9, 3.753191956790797*^9}, {3.7531919966821337`*^9, 
   3.753192018426484*^9}, {3.753192204055208*^9, 3.753192227743846*^9}, {
   3.753192282752194*^9, 3.753192309897202*^9}, {3.753192434478826*^9, 
   3.753192439751423*^9}, {3.753192473682621*^9, 3.75319250562779*^9}, {
   3.7531929034854813`*^9, 3.753192903993767*^9}, {3.753192977433702*^9, 
   3.753193051370789*^9}, {3.753193389646813*^9, 3.753193408305766*^9}, {
   3.7531937731758833`*^9, 3.753193774594428*^9}, {3.753193828253644*^9, 
   3.753193838194858*^9}, {3.7531938721746073`*^9, 3.753194052971347*^9}, {
   3.753194109724455*^9, 3.753194153217959*^9}, {3.7531942729327087`*^9, 
   3.7531942754972897`*^9}, {3.7531943130476313`*^9, 
   3.7531943323767138`*^9}, {3.7531944339646587`*^9, 3.753194455407908*^9}, {
   3.753194493814712*^9, 3.753194495395101*^9}, {3.753194527702331*^9, 
   3.753194530190557*^9}, {3.753195007277403*^9, 3.75319500808077*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "maximum", " ", "peaks", " ", "in", " ", "the", " ", 
    "filtered", " ", "data"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxs", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"filtData", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "filtData"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxsPos", " ", "=", " ", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"filtData", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"maxs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", "filtData"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Get", " ", "the", " ", "time", " ", "data"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"times", " ", "=", " ", 
   RowBox[{"time", "[", 
    RowBox[{"[", "maxsPos", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]times", " ", "=", " ", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"time", "[", 
        RowBox[{"[", 
         RowBox[{"maxsPos", "+", "1"}], "]"}], "]"}], " ", "-", " ", 
       RowBox[{"time", "[", 
        RowBox[{"[", 
         RowBox[{"maxsPos", "-", "1"}], "]"}], "]"}]}], "]"}], "/", "2"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Get", " ", "the", " ", "frequency", " ", "data"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqs", " ", "=", " ", 
   RowBox[{"freq", "[", 
    RowBox[{"[", 
     RowBox[{"9", ";;", "28"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqs", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"freqs", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqs", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"freqs", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqs", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"freqs", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqs", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"freqs", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqs", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"freqs", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqs", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"freqs", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqs", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"freqs", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqs", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"freqs", ",", "12"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqs", " ", "=", " ", 
   RowBox[{"Delete", "[", 
    RowBox[{"freqs", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"freqs", " ", "=", " ", 
    RowBox[{"Delete", "[", 
     RowBox[{"freqs", ",", "1"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xdata", " ", "=", " ", 
    RowBox[{
     SuperscriptBox["10", "4"], "/", 
     RowBox[{"(", 
      RowBox[{"2.410", "*", 
       SuperscriptBox["freqs", "2"]}], ")"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "Fitting", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitData", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"xdata", ",", "times"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lm", " ", "=", " ", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{"fitData", ",", "x", ",", "x", ",", " ", 
     RowBox[{"Weights", "\[Rule]", 
      RowBox[{"1", "/", 
       SuperscriptBox["\[Sigma]times", "2"]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotData", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fitData", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"ErrorBar", "[", 
         RowBox[{"\[Sigma]times", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "fitData"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"The", " ", "plot"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ErrorListPlot", "[", 
     RowBox[{"plotData", ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", "Black", "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"lm", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"Min", "[", "xdata", "]"}], ",", 
        RowBox[{"Max", "[", "xdata", "]"}]}], "}"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Thick"}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "700"}], ",", " ", 
    RowBox[{"PlotLabel", "->", "\"\<Time Delay vs Frequency\>\""}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<(\[ScriptCapitalD]*\!\(\*SuperscriptBox[\(\[Nu]\), \
\(2\)]\)\!\(\*SuperscriptBox[\()\), \(-1\)]\) [\!\(\*SuperscriptBox[\(cm\), \
\(3\)]\)\!\(\*SuperscriptBox[\(pc\), \(-1\)]\)\!\(\*SuperscriptBox[\(s\), \
\(-1\)]\)]\>\"", ",", "\"\<\!\(\*SubscriptBox[\(t\), \(A\)]\) [s]\>\""}], 
      "}"}]}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "20", "]"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"20", ",", "Black"}], "]"}]}], ",", " ", 
    RowBox[{"Epilog", "->", 
     RowBox[{"{", " ", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"Framed", "[", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<DM = \>\"", " ", "<>", " ", 
              RowBox[{"ToString", "@", 
               RowBox[{
                RowBox[{"lm", "[", "\"\<BestFitParameters\>\"", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], " ", "<>", " ", 
              "\"\< \[PlusMinus] \>\"", " ", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{
                RowBox[{"lm", "[", "\"\<ParameterErrors\>\"", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "Times"}], ",", " ", 
             RowBox[{"FontSize", "\[Rule]", "20"}]}], "]"}], "]"}], ",", " ", 
          
          RowBox[{"RoundingRadius", "\[Rule]", "2"}]}], "]"}], ",", " ", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"0.75", ",", "0.15"}], "}"}], "]"}]}], "]"}], "}"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"spectrumFitsDir", ",", 
      RowBox[{"pulsarName", " ", "<>", " ", "\"\<.png\>\""}]}], "}"}], "]"}], 
   ",", "%"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"lm", "[", "\"\<ParameterTable\>\"", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.752953151172419*^9, 3.752953263430138*^9}, {
   3.752953308673787*^9, 3.7529533154949083`*^9}, {3.752953368994431*^9, 
   3.752953393751223*^9}, {3.752953450695449*^9, 3.752953451633235*^9}, {
   3.752953490514285*^9, 3.752953766255198*^9}, {3.752953840181234*^9, 
   3.7529538583182898`*^9}, {3.752955103892872*^9, 3.752955121279016*^9}, {
   3.7529551908649263`*^9, 3.7529552690392027`*^9}, {3.752955396214458*^9, 
   3.752955452853033*^9}, {3.752955615673788*^9, 3.7529559587684107`*^9}, {
   3.7529560247191677`*^9, 3.752956311804578*^9}, {3.75295657767763*^9, 
   3.752956729249509*^9}, {3.752956797663265*^9, 3.7529567983904037`*^9}, {
   3.752956904423382*^9, 3.752956927581485*^9}, {3.752957125068036*^9, 
   3.752957211559389*^9}, {3.7529572568432713`*^9, 3.752957361516341*^9}, {
   3.752957408847034*^9, 3.752957423570622*^9}, {3.752957517114855*^9, 
   3.752957517593872*^9}, {3.75295759249708*^9, 3.7529576218340197`*^9}, {
   3.752957760055813*^9, 3.752957808168922*^9}, {3.7530326442549334`*^9, 
   3.7530326505424643`*^9}, {3.753036800842702*^9, 3.753036801921111*^9}, {
   3.753038867271245*^9, 3.7530389402503347`*^9}, {3.753042089651963*^9, 
   3.753042124138192*^9}, 3.7530421594845057`*^9, {3.7530422771693487`*^9, 
   3.7530424975792093`*^9}, {3.7530425628075438`*^9, 3.753042789001809*^9}, 
   3.75304286420858*^9, {3.753190151058125*^9, 3.75319015717404*^9}, 
   3.753190352888942*^9, 3.753191058728544*^9, {3.753191392127858*^9, 
   3.753191397620644*^9}, {3.7531921752352343`*^9, 3.753192187073571*^9}, {
   3.7531922704622087`*^9, 3.7531922723208237`*^9}, {3.753192318832575*^9, 
   3.753192319042148*^9}, {3.7531925217532377`*^9, 3.7531925277547083`*^9}, {
   3.7531930629377937`*^9, 3.753193073802574*^9}, {3.753193119221939*^9, 
   3.753193197503977*^9}, {3.753193269117813*^9, 3.753193316473383*^9}, 
   3.753193355278194*^9, {3.753193416631111*^9, 3.7531934360577717`*^9}, {
   3.753194167118182*^9, 3.7531941924371357`*^9}, {3.7531942835201597`*^9, 
   3.753194327773613*^9}, {3.753194403898394*^9, 3.753194404037854*^9}, {
   3.753194437057742*^9, 3.753194451061789*^9}, {3.753194487095438*^9, 
   3.753194488917*^9}, {3.75319452241149*^9, 3.753194523988282*^9}, {
   3.753194569623046*^9, 3.753194569878697*^9}}]
}, Open  ]]
},
WindowSize->{1869, 1052},
WindowMargins->{{-50, Automatic}, {Automatic, 29}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 227, 3, 93, "Title"],
Cell[810, 27, 5692, 130, 323, "Input"],
Cell[6505, 159, 4568, 82, 125, "Input"],
Cell[11076, 243, 2525, 55, 147, "Input"],
Cell[13604, 300, 6500, 147, 341, "Input"],
Cell[20107, 449, 10575, 258, 882, "Input"]
}, Open  ]]
}
]
*)

